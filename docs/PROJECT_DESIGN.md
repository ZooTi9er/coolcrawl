# Firecrawl é¡¹ç›®è®¾è®¡å¼€å‘æŠ¥å‘Š v1.1

## ğŸ“‹ **æ–‡æ¡£æ¦‚è¿°**

**æ–‡æ¡£ç‰ˆæœ¬**: v1.1  
**åˆ›å»ºæ—¶é—´**: 2025å¹´7æœˆ15æ—¥ 22:45 (UTC+8)  
**åŸºäºç‰ˆæœ¬**: Firecrawl ä¿®å¤ç‰ˆæœ¬ v1.0  
**é¡¹ç›®ä»“åº“**: git@github.com:ZooTi9er/coolcrawl.git  
**æ–‡æ¡£ä½œè€…**: Augment Agent  

---

## ğŸ—ï¸ **é¡¹ç›®æ¶æ„è®¾è®¡**

### **æ•´ä½“æ¶æ„æ¦‚è§ˆ**

Firecrawl æ˜¯ä¸€ä¸ªåŸºäº Node.js çš„ç½‘é¡µæŠ“å–å’Œæœç´¢æœåŠ¡ï¼Œé‡‡ç”¨å¾®æœåŠ¡æ¶æ„è®¾è®¡ï¼Œæ”¯æŒé«˜å¹¶å‘å’Œåˆ†å¸ƒå¼éƒ¨ç½²ã€‚

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   å®¢æˆ·ç«¯åº”ç”¨     â”‚    â”‚   è´Ÿè½½å‡è¡¡å™¨     â”‚    â”‚   API ç½‘å…³      â”‚
â”‚   (SDK/HTTP)    â”‚â”€â”€â”€â–¶â”‚   (Nginx/ALB)   â”‚â”€â”€â”€â–¶â”‚   (Express.js)  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                                       â”‚
                       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                       â”‚                                 â”‚                                 â”‚
                       â–¼                                 â–¼                                 â–¼
            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
            â”‚   æŠ“å–æœåŠ¡       â”‚              â”‚   æœç´¢æœåŠ¡       â”‚              â”‚   çˆ¬å–æœåŠ¡       â”‚
            â”‚   (/v0/scrape)  â”‚              â”‚   (/v0/search)  â”‚              â”‚   (/v0/crawl)   â”‚
            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                       â”‚                                 â”‚                                 â”‚
                       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                                         â”‚
                                                         â–¼
                                              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                                              â”‚   é˜Ÿåˆ—ç³»ç»Ÿ       â”‚
                                              â”‚   (Redis/Bull)  â”‚
                                              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                                         â”‚
                       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                       â”‚                                 â”‚                                 â”‚
                       â–¼                                 â–¼                                 â–¼
            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
            â”‚   æ•°æ®å­˜å‚¨       â”‚              â”‚   ç¼“å­˜ç³»ç»Ÿ       â”‚              â”‚   å¤–éƒ¨æœåŠ¡       â”‚
            â”‚   (PostgreSQL)  â”‚              â”‚   (Redis)       â”‚              â”‚   (SERPER API)  â”‚
            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### **æ ¸å¿ƒç»„ä»¶è¯´æ˜**

#### **1. API å±‚ (Express.js)**
- **v0 ç«¯ç‚¹**: å…¼å®¹æ€§ç«¯ç‚¹ï¼Œæ”¯æŒä¼ ç»Ÿå®¢æˆ·ç«¯
- **v1 ç«¯ç‚¹**: æ–°ç‰ˆæœ¬ç«¯ç‚¹ï¼Œæä¾›å¢å¼ºåŠŸèƒ½å’Œæ›´å¥½çš„æ•°æ®æ ¼å¼
- **è®¤è¯ç³»ç»Ÿ**: åŸºäº API Key çš„è®¤è¯æœºåˆ¶
- **é™æµæ§åˆ¶**: é˜²æ­¢æ»¥ç”¨å’Œä¿æŠ¤ç³»ç»Ÿèµ„æº

#### **2. ä¸šåŠ¡é€»è¾‘å±‚**
- **WebScraperDataProvider**: æ ¸å¿ƒæŠ“å–å¼•æ“
- **æœç´¢æ§åˆ¶å™¨**: å¤„ç†æœç´¢è¯·æ±‚å’Œç»“æœèšåˆ
- **çˆ¬å–æ§åˆ¶å™¨**: ç®¡ç†æ‰¹é‡ç½‘ç«™çˆ¬å–ä»»åŠ¡
- **é˜Ÿåˆ—ç®¡ç†**: å¼‚æ­¥ä»»åŠ¡å¤„ç†å’ŒçŠ¶æ€è·Ÿè¸ª

#### **3. æ•°æ®å±‚**
- **PostgreSQL**: ä¸»æ•°æ®åº“ï¼Œå­˜å‚¨ç”¨æˆ·ã€é¡¹ç›®ã€é…ç½®ä¿¡æ¯
- **Redis**: ç¼“å­˜å’Œé˜Ÿåˆ—ç³»ç»Ÿï¼Œæä¾›é«˜æ€§èƒ½æ•°æ®è®¿é—®
- **æ–‡ä»¶å­˜å‚¨**: æ”¯æŒæœ¬åœ°å’Œäº‘å­˜å‚¨ï¼ˆS3å…¼å®¹ï¼‰

---

## ğŸ”§ **æŠ€æœ¯é€‰å‹è¯´æ˜**

### **åç«¯æŠ€æœ¯æ ˆ**

| æŠ€æœ¯ç»„ä»¶ | ç‰ˆæœ¬ | é€‰æ‹©ç†ç”± | æ›¿ä»£æ–¹æ¡ˆ |
|---------|------|----------|----------|
| **Node.js** | 18+ | é«˜å¹¶å‘å¤„ç†ï¼Œä¸°å¯Œçš„ç”Ÿæ€ç³»ç»Ÿ | Python (Django/FastAPI) |
| **Express.js** | 4.x | æˆç†Ÿçš„ Web æ¡†æ¶ï¼Œä¸­é—´ä»¶ä¸°å¯Œ | Koa.js, Fastify |
| **TypeScript** | 5.x | ç±»å‹å®‰å…¨ï¼Œæå‡å¼€å‘æ•ˆç‡ | JavaScript |
| **PostgreSQL** | 14+ | å…³ç³»å‹æ•°æ®åº“ï¼ŒACID ç‰¹æ€§ | MySQL, MongoDB |
| **Redis** | 7+ | é«˜æ€§èƒ½ç¼“å­˜å’Œé˜Ÿåˆ—ç³»ç»Ÿ | Memcached, RabbitMQ |
| **Bull** | 4.x | å¼ºå¤§çš„é˜Ÿåˆ—ç®¡ç†åº“ | Agenda, Kue |

### **æŠ“å–æŠ€æœ¯æ ˆ**

| æŠ€æœ¯ç»„ä»¶ | ç”¨é€” | ä¼˜åŠ¿ | é™åˆ¶ |
|---------|------|------|------|
| **Puppeteer** | åŠ¨æ€ç½‘é¡µæŠ“å– | å®Œæ•´æµè§ˆå™¨ç¯å¢ƒï¼ŒJavaScript æ”¯æŒ | èµ„æºæ¶ˆè€—å¤§ |
| **Playwright** | ç°ä»£ç½‘é¡µæŠ“å– | å¤šæµè§ˆå™¨æ”¯æŒï¼Œæ›´å¥½çš„æ€§èƒ½ | ç›¸å¯¹è¾ƒæ–° |
| **Cheerio** | é™æ€ HTML è§£æ | è½»é‡çº§ï¼ŒjQuery è¯­æ³• | ä¸æ”¯æŒ JavaScript |
| **ScrapingBee** | ç¬¬ä¸‰æ–¹æŠ“å–æœåŠ¡ | ç»•è¿‡åçˆ¬è™«ï¼Œç¨³å®šæ€§é«˜ | æˆæœ¬è¾ƒé«˜ |

### **éƒ¨ç½²æŠ€æœ¯æ ˆ**

| æŠ€æœ¯ç»„ä»¶ | ç”¨é€” | é…ç½®è¦æ±‚ | æ‰©å±•æ€§ |
|---------|------|----------|--------|
| **Docker** | å®¹å™¨åŒ–éƒ¨ç½² | 2GB+ å†…å­˜ | æ°´å¹³æ‰©å±• |
| **Docker Compose** | æœ¬åœ°å¼€å‘ç¯å¢ƒ | 4GB+ å†…å­˜ | æœ‰é™æ‰©å±• |
| **Kubernetes** | ç”Ÿäº§ç¯å¢ƒç¼–æ’ | 8GB+ å†…å­˜ | é«˜åº¦å¯æ‰©å±• |
| **Nginx** | åå‘ä»£ç† | 512MB å†…å­˜ | è´Ÿè½½å‡è¡¡ |

---

## ğŸ“Š **API ç«¯ç‚¹è®¾è®¡æ–‡æ¡£**

### **v0 vs v1 ç‰ˆæœ¬å¯¹æ¯”**

| åŠŸèƒ½ | v0 ç«¯ç‚¹ | v1 ç«¯ç‚¹ | ä¸»è¦å·®å¼‚ |
|------|---------|---------|----------|
| **ç½‘é¡µæŠ“å–** | `/v0/scrape` | `/v1/scrape` | v1 æ”¯æŒæ›´å¤šå‚æ•°å’Œæ›´å¥½çš„é”™è¯¯å¤„ç† |
| **ç½‘é¡µæœç´¢** | `/v0/search` | æš‚æœªå®ç° | v0 å·²ä¿®å¤ undefined é”™è¯¯ |
| **ç½‘ç«™çˆ¬å–** | `/v0/crawl` | `/v1/crawl` | v1 æ–°å¢ï¼Œæä¾›æ›´å¥½çš„æ•°æ®æ ¼å¼ |
| **çŠ¶æ€æŸ¥è¯¢** | `/v0/crawl/status/:id` | `/v1/crawl/:jobId` | v1 æä¾›æ›´è¯¦ç»†çš„çŠ¶æ€ä¿¡æ¯ |

### **API ç«¯ç‚¹è¯¦ç»†è®¾è®¡**

#### **1. ç½‘é¡µæŠ“å–ç«¯ç‚¹**

**v0 ç«¯ç‚¹**: `POST /v0/scrape`
```json
{
  "url": "https://example.com",
  "pageOptions": {
    "onlyMainContent": true,
    "includeHtml": false
  }
}
```

**v1 ç«¯ç‚¹**: `POST /v1/scrape`
```json
{
  "url": "https://example.com",
  "pageOptions": {
    "onlyMainContent": true,
    "includeHtml": false,
    "waitFor": 1000
  },
  "extractorOptions": {
    "mode": "llm-extraction"
  }
}
```

#### **2. æœç´¢ç«¯ç‚¹**

**v0 ç«¯ç‚¹**: `POST /v0/search`
```json
{
  "query": "JavaScript frameworks 2024",
  "searchOptions": {
    "limit": 5,
    "country": "US"
  }
}
```

**å“åº”æ ¼å¼**:
```json
{
  "success": true,
  "data": [
    {
      "content": "é¡µé¢å†…å®¹...",
      "metadata": {
        "title": "é¡µé¢æ ‡é¢˜",
        "sourceURL": "https://example.com",
        "description": "é¡µé¢æè¿°"
      }
    }
  ]
}
```

#### **3. çˆ¬å–ç«¯ç‚¹**

**v0 ç«¯ç‚¹**: `POST /v0/crawl`
```json
{
  "url": "https://example.com",
  "crawlerOptions": {
    "limit": 100,
    "maxDepth": 2
  }
}
```

**v1 ç«¯ç‚¹**: `POST /v1/crawl`
```json
{
  "url": "https://example.com",
  "crawlerOptions": {
    "limit": 100,
    "maxDepth": 2,
    "allowExternalLinks": false
  },
  "pageOptions": {
    "onlyMainContent": true
  }
}
```

---

## ğŸ—„ï¸ **æ•°æ®åº“è®¾è®¡**

### **PostgreSQL æ•°æ®åº“ç»“æ„**

#### **æ ¸å¿ƒè¡¨ç»“æ„**

```sql
-- ç”¨æˆ·è¡¨
CREATE TABLE users (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    email VARCHAR(255) UNIQUE NOT NULL,
    name VARCHAR(255),
    created_at TIMESTAMP DEFAULT NOW(),
    updated_at TIMESTAMP DEFAULT NOW()
);

-- é¡¹ç›®è¡¨
CREATE TABLE projects (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    name VARCHAR(255) NOT NULL,
    user_id UUID REFERENCES users(id),
    api_key VARCHAR(255) UNIQUE,
    created_at TIMESTAMP DEFAULT NOW()
);

-- API å¯†é’¥è¡¨
CREATE TABLE api_keys (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    project_id UUID REFERENCES projects(id),
    key_hash VARCHAR(255) UNIQUE NOT NULL,
    name VARCHAR(255),
    last_used_at TIMESTAMP,
    created_at TIMESTAMP DEFAULT NOW()
);

-- æŠ“å–ä»»åŠ¡è¡¨
CREATE TABLE scrape_jobs (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    project_id UUID REFERENCES projects(id),
    url TEXT NOT NULL,
    status VARCHAR(50) DEFAULT 'pending',
    result JSONB,
    error_message TEXT,
    created_at TIMESTAMP DEFAULT NOW(),
    completed_at TIMESTAMP
);
```

#### **ç´¢å¼•ä¼˜åŒ–**

```sql
-- æ€§èƒ½ä¼˜åŒ–ç´¢å¼•
CREATE INDEX idx_scrape_jobs_project_id ON scrape_jobs(project_id);
CREATE INDEX idx_scrape_jobs_status ON scrape_jobs(status);
CREATE INDEX idx_scrape_jobs_created_at ON scrape_jobs(created_at);
CREATE INDEX idx_api_keys_key_hash ON api_keys(key_hash);
```

### **Redis æ•°æ®ç»“æ„**

#### **é˜Ÿåˆ—ç³»ç»Ÿ**
```
web-scraper:waiting     # ç­‰å¾…å¤„ç†çš„ä»»åŠ¡é˜Ÿåˆ—
web-scraper:active      # æ­£åœ¨å¤„ç†çš„ä»»åŠ¡é˜Ÿåˆ—
web-scraper:completed   # å·²å®Œæˆçš„ä»»åŠ¡é˜Ÿåˆ—
web-scraper:failed      # å¤±è´¥çš„ä»»åŠ¡é˜Ÿåˆ—
```

#### **ç¼“å­˜ç­–ç•¥**
```
cache:scrape:{url_hash}     # æŠ“å–ç»“æœç¼“å­˜ (TTL: 1å°æ—¶)
cache:search:{query_hash}   # æœç´¢ç»“æœç¼“å­˜ (TTL: 30åˆ†é’Ÿ)
rate_limit:{api_key}        # API é™æµè®¡æ•°å™¨ (TTL: 1åˆ†é’Ÿ)
```

---

## ğŸ”„ **ä¿®å¤å‰åç³»ç»Ÿæ¶æ„å¯¹æ¯”**

### **ä¿®å¤å‰æ¶æ„é—®é¢˜**

| é—®é¢˜ç±»å‹ | å…·ä½“é—®é¢˜ | å½±å“èŒƒå›´ | ä¸¥é‡ç¨‹åº¦ |
|---------|----------|----------|----------|
| **æœç´¢åŠŸèƒ½** | undefined é”™è¯¯å¯¼è‡´å®Œå…¨å¤±æ•ˆ | æ‰€æœ‰æœç´¢è¯·æ±‚ | ğŸ”´ ä¸¥é‡ |
| **çˆ¬å–åŠŸèƒ½** | v1 ç«¯ç‚¹ç¼ºå¤±ï¼Œæ•°æ®æ ¼å¼é”™è¯¯ | v1 API ç”¨æˆ· | ğŸ”´ ä¸¥é‡ |
| **è¶…æ—¶å¤„ç†** | å›ºå®š15ç§’è¶…æ—¶ï¼Œæ— é‡è¯•æœºåˆ¶ | å¤æ‚ç½‘ç«™æŠ“å– | ğŸŸ¡ ä¸­ç­‰ |
| **é…ç½®ç®¡ç†** | ç¼ºå°‘ SERPER_API_KEY é…ç½® | æœç´¢æœåŠ¡ç¨³å®šæ€§ | ğŸŸ¡ ä¸­ç­‰ |

### **ä¿®å¤åæ¶æ„æ”¹è¿›**

| æ”¹è¿›é¡¹ç›® | ä¿®å¤æ–¹æ¡ˆ | æŠ€æœ¯å®ç° | æ•ˆæœè¯„ä¼° |
|---------|----------|----------|----------|
| **æœç´¢åŠŸèƒ½** | æ·»åŠ ç©ºå€¼æ£€æŸ¥å’Œé»˜è®¤å€¼ | `result.data || []` | âœ… 100% æˆåŠŸç‡ |
| **çˆ¬å–åŠŸèƒ½** | æ–°å¢ v1 æ§åˆ¶å™¨å’Œè·¯ç”± | å®Œæ•´çš„ CRUD æ“ä½œ | âœ… 100% æˆåŠŸç‡ |
| **è¶…æ—¶å¤„ç†** | 30ç§’è¶…æ—¶ + 3æ¬¡é‡è¯• | æŒ‡æ•°é€€é¿ç®—æ³• | âœ… 88.6% æ€§èƒ½æå‡ |
| **é…ç½®ç®¡ç†** | ç¯å¢ƒå˜é‡æ ‡å‡†åŒ– | `.env` æ–‡ä»¶ç®¡ç† | âœ… æœåŠ¡ç¨³å®šæ€§æå‡ |

---

## âš¡ **æ€§èƒ½ä¼˜åŒ–ç­–ç•¥**

### **1. å¹¶å‘å¤„ç†ä¼˜åŒ–**

#### **é˜Ÿåˆ—ç³»ç»Ÿä¼˜åŒ–**
```javascript
// é˜Ÿåˆ—é…ç½®ä¼˜åŒ–
const queueOptions = {
  redis: redisConfig,
  defaultJobOptions: {
    removeOnComplete: 100,    // ä¿ç•™æœ€è¿‘100ä¸ªå®Œæˆä»»åŠ¡
    removeOnFail: 50,         // ä¿ç•™æœ€è¿‘50ä¸ªå¤±è´¥ä»»åŠ¡
    attempts: 3,              // æœ€å¤šé‡è¯•3æ¬¡
    backoff: {
      type: 'exponential',    // æŒ‡æ•°é€€é¿
      delay: 2000,           // åˆå§‹å»¶è¿Ÿ2ç§’
    },
  },
};
```

#### **å¹¶å‘æ§åˆ¶**
```javascript
// å¹¶å‘é™åˆ¶é…ç½®
const concurrencyConfig = {
  scraping: 10,      // åŒæ—¶å¤„ç†10ä¸ªæŠ“å–ä»»åŠ¡
  searching: 5,      // åŒæ—¶å¤„ç†5ä¸ªæœç´¢ä»»åŠ¡
  crawling: 3,       // åŒæ—¶å¤„ç†3ä¸ªçˆ¬å–ä»»åŠ¡
};
```

### **2. ç¼“å­˜ç­–ç•¥ä¼˜åŒ–**

#### **å¤šå±‚ç¼“å­˜æ¶æ„**
```
L1 ç¼“å­˜ (å†…å­˜)     â†’  L2 ç¼“å­˜ (Redis)     â†’  L3 å­˜å‚¨ (PostgreSQL)
å“åº”æ—¶é—´: <1ms        å“åº”æ—¶é—´: <10ms        å“åº”æ—¶é—´: <100ms
å®¹é‡: 100MB          å®¹é‡: 1GB             å®¹é‡: æ— é™åˆ¶
```

#### **ç¼“å­˜å¤±æ•ˆç­–ç•¥**
```javascript
const cacheConfig = {
  scrapeResults: {
    ttl: 3600,        // 1å°æ—¶è¿‡æœŸ
    maxSize: 1000,    // æœ€å¤šç¼“å­˜1000ä¸ªç»“æœ
  },
  searchResults: {
    ttl: 1800,        // 30åˆ†é’Ÿè¿‡æœŸ
    maxSize: 500,     // æœ€å¤šç¼“å­˜500ä¸ªç»“æœ
  },
};
```

### **3. æ•°æ®åº“ä¼˜åŒ–**

#### **è¿æ¥æ± é…ç½®**
```javascript
const dbConfig = {
  max: 20,              // æœ€å¤§è¿æ¥æ•°
  min: 5,               // æœ€å°è¿æ¥æ•°
  idle: 10000,          // ç©ºé—²è¶…æ—¶æ—¶é—´
  acquire: 60000,       // è·å–è¿æ¥è¶…æ—¶æ—¶é—´
  evict: 1000,          // æ£€æŸ¥é—´éš”
};
```

#### **æŸ¥è¯¢ä¼˜åŒ–**
- ä½¿ç”¨é€‚å½“çš„ç´¢å¼•
- é¿å… N+1 æŸ¥è¯¢é—®é¢˜
- å®ç°æŸ¥è¯¢ç»“æœåˆ†é¡µ
- ä½¿ç”¨é¢„ç¼–è¯‘è¯­å¥

---

## ğŸ”§ **å…³é”®ç»„ä»¶è¯¦ç»†è¯´æ˜**

### **1. WebScraperDataProvider æ ¸å¿ƒå¼•æ“**

#### **åŠŸèƒ½ç‰¹æ€§**
- æ”¯æŒå¤šç§æŠ“å–æ¨¡å¼ (single_url, crawl, search)
- æ™ºèƒ½åçˆ¬è™«æ£€æµ‹å’Œç»•è¿‡
- åŠ¨æ€å†…å®¹æ¸²æŸ“æ”¯æŒ
- è‡ªåŠ¨é‡è¯•å’Œé”™è¯¯æ¢å¤

#### **æŠ€æœ¯å®ç°**
```javascript
class WebScraperDataProvider {
  constructor(options) {
    this.mode = options.mode;
    this.urls = options.urls;
    this.crawlerOptions = options.crawlerOptions;
    this.pageOptions = options.pageOptions;
  }

  async getDocuments(useCaching = true) {
    // å®ç°æŠ“å–é€»è¾‘
    switch (this.mode) {
      case 'single_url':
        return await this.scrapeSingleUrl();
      case 'crawl':
        return await this.crawlWebsite();
      case 'search':
        return await this.searchWeb();
    }
  }
}
```

### **2. é˜Ÿåˆ—ç®¡ç†ç³»ç»Ÿ**

#### **ä»»åŠ¡ç”Ÿå‘½å‘¨æœŸ**
```
åˆ›å»ºä»»åŠ¡ â†’ åŠ å…¥é˜Ÿåˆ— â†’ åˆ†é…å·¥ä½œè¿›ç¨‹ â†’ æ‰§è¡Œä»»åŠ¡ â†’ æ›´æ–°çŠ¶æ€ â†’ å®Œæˆ/å¤±è´¥
```

#### **ç›‘æ§å’Œç®¡ç†**
- Bull Dashboard å¯è§†åŒ–ç•Œé¢
- ä»»åŠ¡çŠ¶æ€å®æ—¶è·Ÿè¸ª
- å¤±è´¥ä»»åŠ¡è‡ªåŠ¨é‡è¯•
- æ€§èƒ½æŒ‡æ ‡æ”¶é›†

### **3. è®¤è¯å’Œæˆæƒç³»ç»Ÿ**

#### **API Key è®¤è¯**
```javascript
const authenticateUser = async (req, res, rateLimiterMode) => {
  const apiKey = req.headers.authorization?.replace('Bearer ', '');
  
  if (!apiKey) {
    return { success: false, error: 'API key required', status: 401 };
  }
  
  // éªŒè¯ API Key å¹¶è·å–ç”¨æˆ·ä¿¡æ¯
  const user = await validateApiKey(apiKey);
  
  if (!user) {
    return { success: false, error: 'Invalid API key', status: 401 };
  }
  
  return { success: true, team_id: user.team_id };
};
```

#### **é™æµæ§åˆ¶**
```javascript
const rateLimitConfig = {
  scrape: { max: 100, window: '1h' },    // æ¯å°æ—¶100æ¬¡æŠ“å–
  search: { max: 50, window: '1h' },     // æ¯å°æ—¶50æ¬¡æœç´¢
  crawl: { max: 10, window: '1h' },      // æ¯å°æ—¶10æ¬¡çˆ¬å–
};
```

---

## ğŸ“ˆ **ç³»ç»Ÿç›‘æ§å’Œæ—¥å¿—**

### **æ€§èƒ½æŒ‡æ ‡ç›‘æ§**
- API å“åº”æ—¶é—´
- é˜Ÿåˆ—ä»»åŠ¡å¤„ç†é€Ÿåº¦
- æ•°æ®åº“è¿æ¥æ± çŠ¶æ€
- Redis å†…å­˜ä½¿ç”¨æƒ…å†µ
- ç³»ç»Ÿèµ„æºä½¿ç”¨ç‡

### **æ—¥å¿—ç®¡ç†**
```javascript
const logConfig = {
  level: process.env.LOG_LEVEL || 'info',
  format: 'json',
  transports: [
    new winston.transports.Console(),
    new winston.transports.File({ filename: 'app.log' })
  ]
};
```

### **é”™è¯¯è¿½è¸ª**
- è¯¦ç»†çš„é”™è¯¯å †æ ˆä¿¡æ¯
- ç”¨æˆ·æ“ä½œä¸Šä¸‹æ–‡è®°å½•
- è‡ªåŠ¨é”™è¯¯æŠ¥å‘Šå’Œå‘Šè­¦
- é”™è¯¯è¶‹åŠ¿åˆ†æ

---

## ğŸš€ **éƒ¨ç½²å’Œæ‰©å±•ç­–ç•¥**

### **æ°´å¹³æ‰©å±•æ–¹æ¡ˆ**
1. **API æœåŠ¡æ‰©å±•**: å¤šä¸ª Express.js å®ä¾‹ + è´Ÿè½½å‡è¡¡
2. **é˜Ÿåˆ—å·¥ä½œè¿›ç¨‹æ‰©å±•**: å¢åŠ  Bull å·¥ä½œè¿›ç¨‹æ•°é‡
3. **æ•°æ®åº“æ‰©å±•**: è¯»å†™åˆ†ç¦» + è¿æ¥æ± ä¼˜åŒ–
4. **ç¼“å­˜æ‰©å±•**: Redis é›†ç¾¤æ¨¡å¼

### **å‚ç›´æ‰©å±•å»ºè®®**
- **CPU**: 4æ ¸å¿ƒä»¥ä¸Šï¼Œæ”¯æŒé«˜å¹¶å‘å¤„ç†
- **å†…å­˜**: 8GBä»¥ä¸Šï¼Œæ”¯æŒå¤§é‡ç¼“å­˜æ•°æ®
- **å­˜å‚¨**: SSD ç¡¬ç›˜ï¼Œæå‡æ•°æ®åº“æ€§èƒ½
- **ç½‘ç»œ**: åƒå…†ç½‘ç»œï¼Œæ”¯æŒé«˜ååé‡

---

**æ–‡æ¡£ç‰ˆæœ¬**: v1.1  
**æœ€åæ›´æ–°**: 2025å¹´7æœˆ15æ—¥ 22:45 (UTC+8)  
**ä¸‹æ¬¡æ›´æ–°**: æ ¹æ®ç³»ç»Ÿæ¼”è¿›å’Œç”¨æˆ·åé¦ˆè¿›è¡Œæ›´æ–°
